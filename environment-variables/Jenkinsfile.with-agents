pipeline {

    agent any

    environment {
        FAVOURITE_FRUIT = 'tomato'
    }

    stages {
        stage('set a var') {
            agent {
                label 'maven'
            }

            steps {
                // This prints out all environment variables, sorted alphabetically
                // You should see the variables declared further below
                sh 'printenv | sort'

                script {
                    TUBE_STATUS = 'delayed'
                    env.YESTERDAYS_WEATHER = 'foggy'
                }
            }
        }

        stage('read a var') {
            agent {
                // Even though this uses the same type of agent as the previous stage,
                // Jenkins Kubernetes plugin will spin up a new pod.
                label 'maven'
            }
            steps {
                // Print the environment variables
                sh 'printenv | sort'

                // This will print 'The tube is currently delayed'
                // because the value for TUBE_STATUS set in the script block is carried over.
                sh 'echo The tube is currently ${TUBE_STATUS}'
                // And now with double-quotes
                sh "echo The tube is currently ${TUBE_STATUS}"

                sh 'echo Yesterday\'s weather was ${YESTERDAYS_WEATHER}'
            }
        }
    }

}
